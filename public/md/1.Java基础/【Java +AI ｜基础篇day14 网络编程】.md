# 14ğŸŒ Java Day14 - ç½‘ç»œç¼–ç¨‹

> ğŸ’¡ **æ ¸å¿ƒæç¤º**ï¼šç½‘ç»œç¼–ç¨‹æ˜¯ Java å®ç°åˆ†å¸ƒå¼åº”ç”¨çš„åŸºç¡€ï¼Œæœ¬æ–‡ç³»ç»Ÿè®²è§£ç½‘ç»œåŸºç¡€ã€Socket ç¼–ç¨‹ã€TCP/UDP é€šä¿¡ç­‰æ ¸å¿ƒå†…å®¹ï¼Œå¸®ä½ æŒæ¡ Java ç½‘ç»œç¼–ç¨‹ã€‚

---

## å¿«é€Ÿå›é¡¾

- **ç½‘ç»œåŸºç¡€**ï¼šIP åœ°å€æ ‡è¯†ä¸»æœºï¼Œç«¯å£å·æ ‡è¯†è¿›ç¨‹ï¼Œåè®®å®šä¹‰é€šä¿¡è§„åˆ™
- **TCP**ï¼šé¢å‘è¿æ¥ã€å¯é ä¼ è¾“ã€é€‚åˆæ–‡ä»¶ä¼ è¾“ã€HTTP ç­‰
- **UDP**ï¼šæ— è¿æ¥ã€ä¸å¯é ã€ä½å»¶è¿Ÿã€é€‚åˆè§†é¢‘æµã€DNS ç­‰
- **Socket**ï¼šç½‘ç»œé€šä¿¡çš„ç«¯ç‚¹ï¼Œæ˜¯ IP + ç«¯å£çš„æŠ½è±¡

---

## ç›®å½•

- [ä¸€ã€ç½‘ç»œåŸºç¡€](#ä¸€ç½‘ç»œåŸºç¡€)
  - [1. ç½‘ç»œé€šä¿¡ä¸‰è¦ç´ ](#1-ç½‘ç»œé€šä¿¡ä¸‰è¦ç´ )
  - [2. IP åœ°å€åˆ†ç±»](#2-ip-åœ°å€åˆ†ç±»)
  - [3. ç«¯å£åˆ†ç±»](#3-ç«¯å£åˆ†ç±»)
- [äºŒã€TCP é€šä¿¡](#äºŒtcp-é€šä¿¡)
  - [1. TCP ç‰¹ç‚¹](#1-tcp-ç‰¹ç‚¹)
  - [2. TCP å®¢æˆ·ç«¯](#2-tcp-å®¢æˆ·ç«¯)
  - [3. TCP æœåŠ¡å™¨](#3-tcp-æœåŠ¡å™¨)
  - [4. æ–‡ä»¶ä¼ è¾“ç¤ºä¾‹](#4-æ–‡ä»¶ä¼ è¾“ç¤ºä¾‹)
- [ä¸‰ã€UDP é€šä¿¡](#ä¸‰udp-é€šä¿¡)
  - [1. UDP ç‰¹ç‚¹](#1-udp-ç‰¹ç‚¹)
  - [2. UDP å‘é€ç«¯](#2-udp-å‘é€ç«¯)
  - [3. UDP æ¥æ”¶ç«¯](#3-udp-æ¥æ”¶ç«¯)
- [å››ã€TCP vs UDP å¯¹æ¯”](#å››tcp-vs-udp-å¯¹æ¯”)
- [äº”ã€ç»¼åˆæ¡ˆä¾‹ï¼šç®€æ˜“èŠå¤©å®¤](#äº”ç»¼åˆæ¡ˆä¾‹ç®€æ˜“èŠå¤©å®¤)
- [é—®ç­”](#é—®ç­”)

---

## è¯¦ç»†å†…å®¹

### ä¸€ã€ç½‘ç»œåŸºç¡€

#### 1. ç½‘ç»œé€šä¿¡ä¸‰è¦ç´ 

| è¦ç´  | ä½œç”¨ | ç¤ºä¾‹ |
|------|------|------|
| **IP åœ°å€** | æ ‡è¯†ç½‘ç»œä¸­çš„è®¾å¤‡ | 192.168.1.1 |
| **ç«¯å£å·** | æ ‡è¯†è®¾å¤‡ä¸Šçš„è¿›ç¨‹ | 80ï¼ˆHTTPï¼‰ã€443ï¼ˆHTTPSï¼‰|
| **åè®®** | å®šä¹‰é€šä¿¡è§„åˆ™ | TCPã€UDPã€HTTP |

#### 2. IP åœ°å€åˆ†ç±»

```java
// è·å–æœ¬æœº IP
InetAddress localHost = InetAddress.getLocalHost();
System.out.println(localHost.getHostName());  // ä¸»æœºå
System.out.println(localHost.getHostAddress()); // IPåœ°å€

// æ ¹æ®åŸŸåè·å– IP
InetAddress byName = InetAddress.getByName("www.baidu.com");
System.out.println(byName.getHostAddress());
```

#### 3. ç«¯å£åˆ†ç±»

| ç±»å‹ | èŒƒå›´ | ç”¨é€” |
|------|------|------|
| çŸ¥åç«¯å£ | 0-1023 | ç³»ç»ŸæœåŠ¡ï¼ˆHTTP:80, HTTPS:443ï¼‰|
| æ³¨å†Œç«¯å£ | 1024-49151 | åº”ç”¨ç¨‹åºæ³¨å†Œä½¿ç”¨ |
| åŠ¨æ€ç«¯å£ | 49152-65535 | å®¢æˆ·ç«¯ä¸´æ—¶ä½¿ç”¨ |

---

### äºŒã€TCP é€šä¿¡

#### 1. TCP ç‰¹ç‚¹

- **é¢å‘è¿æ¥**ï¼šé€šä¿¡å‰éœ€å»ºç«‹è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰
- **å¯é ä¼ è¾“**ï¼šæ•°æ®ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æŒ‰åºåˆ°è¾¾
- **åŸºäºå­—èŠ‚æµ**ï¼šæ•°æ®ä»¥å­—èŠ‚æµå½¢å¼ä¼ è¾“
- **é€‚åˆåœºæ™¯**ï¼šæ–‡ä»¶ä¼ è¾“ã€HTTPã€FTPã€é‚®ä»¶ç­‰

**TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹                  â”‚
â”‚                                                             â”‚
â”‚   å®¢æˆ·ç«¯                           æœåŠ¡å™¨                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    SYN=1     â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    seq=x     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚    SYN=1     â”‚         â”‚
â”‚   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    ACK=x+1   â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚    seq=y     â”‚         â”‚
â”‚   â”‚    ACK=y+1   â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    è¿æ¥å»ºç«‹   â”‚                 â”‚    è¿æ¥å»ºç«‹   â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚   çŠ¶æ€å˜åŒ–ï¼šSYN_SENT â†’ ESTABLISHED    SYN_RECV â†’ ESTABLISHEDâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**TCP å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TCP å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹                  â”‚
â”‚                                                             â”‚
â”‚   å®¢æˆ·ç«¯                           æœåŠ¡å™¨                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    FIN=1     â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    seq=u     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚    ACK=u+1   â”‚         â”‚
â”‚   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    seq=v     â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚   ç­‰å¾…å…³é—­   â”‚                 â”‚  ç»§ç»­å‘é€æ•°æ® â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚    FIN=1     â”‚         â”‚
â”‚   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    seq=w     â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚    ACK=w+1   â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚   è¿æ¥å…³é—­   â”‚                 â”‚   è¿æ¥å…³é—­    â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚   çŠ¶æ€å˜åŒ–ï¼šFIN_WAIT1â†’FIN_WAIT2â†’TIME_WAITâ†’CLOSED           â”‚
â”‚            LAST_ACKâ†’CLOSED                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. TCP å®¢æˆ·ç«¯

```java
import java.io.*;
import java.net.*;

public class TCPClient {
    public static void main(String[] args) {
        try (Socket socket = new Socket("127.0.0.1", 8888);
             PrintWriter out = new PrintWriter(
                 socket.getOutputStream(), true);
             BufferedReader in = new BufferedReader(
                 new InputStreamReader(socket.getInputStream()));
             BufferedReader userInput = new BufferedReader(
                 new InputStreamReader(System.in))) {
            
            System.out.println("å·²è¿æ¥åˆ°æœåŠ¡å™¨");
            
            String userLine;
            while ((userLine = userInput.readLine()) != null) {
                out.println(userLine);  // å‘é€æ¶ˆæ¯
                String response = in.readLine();  // æ¥æ”¶å“åº”
                System.out.println("æœåŠ¡å™¨ï¼š" + response);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

#### 3. TCP æœåŠ¡å™¨

```java
import java.io.*;
import java.net.*;

public class TCPServer {
    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(8888)) {
            System.out.println("æœåŠ¡å™¨å¯åŠ¨ï¼Œç­‰å¾…è¿æ¥...");
            
            while (true) {
                Socket clientSocket = serverSocket.accept();
                System.out.println("å®¢æˆ·ç«¯è¿æ¥ï¼š" + 
                    clientSocket.getInetAddress());
                
                // ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºæ–°çº¿ç¨‹
                new Thread(new ClientHandler(clientSocket)).start();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

class ClientHandler implements Runnable {
    private Socket socket;
    
    public ClientHandler(Socket socket) {
        this.socket = socket;
    }
    
    @Override
    public void run() {
        try (BufferedReader in = new BufferedReader(
                new InputStreamReader(socket.getInputStream()));
             PrintWriter out = new PrintWriter(
                socket.getOutputStream(), true)) {
            
            String message;
            while ((message = in.readLine()) != null) {
                System.out.println("æ”¶åˆ°ï¼š" + message);
                out.println("æ”¶åˆ°ï¼š" + message);  // å›å£°
            }
        } catch (IOException e) {
            System.out.println("å®¢æˆ·ç«¯æ–­å¼€");
        }
    }
}
```

#### 4. æ–‡ä»¶ä¼ è¾“ç¤ºä¾‹

```java
// å®¢æˆ·ç«¯å‘é€æ–‡ä»¶
public void sendFile(String filePath, String host, int port) {
    try (Socket socket = new Socket(host, port);
         FileInputStream fis = new FileInputStream(filePath);
         BufferedOutputStream bos = new BufferedOutputStream(
             socket.getOutputStream())) {
        
        byte[] buffer = new byte[1024];
        int len;
        while ((len = fis.read(buffer)) != -1) {
            bos.write(buffer, 0, len);
        }
        bos.flush();
        System.out.println("æ–‡ä»¶å‘é€å®Œæˆ");
    } catch (IOException e) {
        e.printStackTrace();
    }
}

// æœåŠ¡å™¨æ¥æ”¶æ–‡ä»¶
public void receiveFile(String savePath, int port) {
    try (ServerSocket serverSocket = new ServerSocket(port);
         Socket socket = serverSocket.accept();
         BufferedInputStream bis = new BufferedInputStream(
             socket.getInputStream());
         FileOutputStream fos = new FileOutputStream(savePath)) {
        
        byte[] buffer = new byte[1024];
        int len;
        while ((len = bis.read(buffer)) != -1) {
            fos.write(buffer, 0, len);
        }
        System.out.println("æ–‡ä»¶æ¥æ”¶å®Œæˆ");
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

---

### ä¸‰ã€UDP é€šä¿¡

#### 1. UDP ç‰¹ç‚¹

- **æ— è¿æ¥**ï¼šç›´æ¥å‘é€æ•°æ®ï¼Œæ— éœ€å»ºç«‹è¿æ¥
- **ä¸å¯é **ï¼šä¸ä¿è¯æ•°æ®åˆ°è¾¾ï¼Œå¯èƒ½ä¸¢å¤±ã€é‡å¤ã€ä¹±åº
- **æ•°æ®æŠ¥**ï¼šä»¥æ•°æ®åŒ…ä¸ºå•ä½ä¼ è¾“
- **ä½å»¶è¿Ÿ**ï¼šæ— éœ€æ¡æ‰‹ï¼Œä¼ è¾“æ•ˆç‡é«˜
- **é€‚åˆåœºæ™¯**ï¼šè§†é¢‘æµã€éŸ³é¢‘æµã€DNSã€æ¸¸æˆç­‰

**UDP é€šä¿¡æµç¨‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              UDP é€šä¿¡æµç¨‹                      â”‚
â”‚                                                             â”‚
â”‚   å‘é€ç«¯                           æ¥æ”¶ç«¯                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚              â”‚                 â”‚              â”‚         â”‚
â”‚   â”‚  åˆ›å»ºæ•°æ®åŒ…   â”‚                 â”‚  åˆ›å»ºSocket   â”‚         â”‚
â”‚   â”‚  DatagramPacketâ”‚               â”‚  DatagramSocketâ”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                                â”‚                 â”‚
â”‚          â–¼                                â–¼                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  åˆ›å»ºSocket   â”‚                 â”‚  ç­‰å¾…æ¥æ”¶æ•°æ® â”‚         â”‚
â”‚   â”‚  DatagramSocketâ”‚               â”‚  receive()   â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                                â”‚                 â”‚
â”‚          â”‚    å‘é€æ•°æ®åŒ…                    â”‚                 â”‚
â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚          â”‚                                â”‚                 â”‚
â”‚          â”‚                                â–¼                 â”‚
â”‚          â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚          â”‚                          â”‚  å¤„ç†æ•°æ®åŒ…   â”‚        â”‚
â”‚          â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚          â”‚                                â”‚                 â”‚
â”‚          â”‚                                â–¼                 â”‚
â”‚          â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚          â”‚                          â”‚  æå–æ•°æ®å†…å®¹ â”‚        â”‚
â”‚          â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â”‚   ç‰¹ç‚¹ï¼šæ— éœ€å»ºç«‹è¿æ¥ï¼Œç›´æ¥å‘é€ï¼Œå¯èƒ½ä¸¢åŒ…ï¼Œæ•ˆç‡é«˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**TCP vs UDP å¯¹æ¯”å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TCP vs UDP å¯¹æ¯”                     â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚      TCP        â”‚         â”‚      UDP        â”‚          â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚   â”‚ è¿æ¥æ–¹å¼ï¼šé¢å‘è¿æ¥â”‚         â”‚ è¿æ¥æ–¹å¼ï¼šæ— è¿æ¥  â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚ å¯é æ€§ï¼šå¯é      â”‚         â”‚ å¯é æ€§ï¼šä¸å¯é    â”‚          â”‚
â”‚   â”‚ (ä¸ä¸¢åŒ…ã€æŒ‰åº)   â”‚         â”‚ (å¯èƒ½ä¸¢åŒ…ã€ä¹±åº) â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚ ä¼ è¾“æ•ˆç‡ï¼šè¾ƒä½   â”‚         â”‚ ä¼ è¾“æ•ˆç‡ï¼šè¾ƒé«˜   â”‚          â”‚
â”‚   â”‚ (éœ€è¦ç¡®è®¤)       â”‚         â”‚ (æ— éœ€ç¡®è®¤)       â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚ æ•°æ®å½¢å¼ï¼šå­—èŠ‚æµ â”‚         â”‚ æ•°æ®å½¢å¼ï¼šæ•°æ®æŠ¥ â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚ åº”ç”¨åœºæ™¯ï¼š       â”‚         â”‚ åº”ç”¨åœºæ™¯ï¼š       â”‚          â”‚
â”‚   â”‚ â€¢ HTTP/HTTPS    â”‚         â”‚ â€¢ è§†é¢‘æµ        â”‚          â”‚
â”‚   â”‚ â€¢ FTP           â”‚         â”‚ â€¢ éŸ³é¢‘æµ        â”‚          â”‚
â”‚   â”‚ â€¢ é‚®ä»¶          â”‚         â”‚ â€¢ DNS          â”‚          â”‚
â”‚   â”‚ â€¢ æ–‡ä»¶ä¼ è¾“      â”‚         â”‚ â€¢ åœ¨çº¿æ¸¸æˆ      â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚ Socketç±»ï¼š       â”‚         â”‚ Socketç±»ï¼š       â”‚          â”‚
â”‚   â”‚ Socket/ServerSocketâ”‚     â”‚ DatagramSocket  â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. UDP å‘é€ç«¯

```java
import java.net.*;

public class UDPSender {
    public static void main(String[] args) {
        try (DatagramSocket socket = new DatagramSocket()) {
            String message = "Hello UDP";
            byte[] data = message.getBytes();
            
            DatagramPacket packet = new DatagramPacket(
                data, 
                data.length,
                InetAddress.getByName("127.0.0.1"),
                9999
            );
            
            socket.send(packet);
            System.out.println("æ¶ˆæ¯å·²å‘é€");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

#### 3. UDP æ¥æ”¶ç«¯

```java
import java.net.*;

public class UDPReceiver {
    public static void main(String[] args) {
        try (DatagramSocket socket = new DatagramSocket(9999)) {
            System.out.println("UDP æ¥æ”¶ç«¯å¯åŠ¨...");
            
            byte[] buffer = new byte[1024];
            DatagramPacket packet = new DatagramPacket(buffer, buffer.length);
            
            socket.receive(packet);  // é˜»å¡ç­‰å¾…æ¥æ”¶
            
            String received = new String(
                packet.getData(), 
                0, 
                packet.getLength()
            );
            System.out.println("æ”¶åˆ°ï¼š" + received);
            System.out.println("æ¥è‡ªï¼š" + packet.getAddress());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

---

### å››ã€TCP vs UDP å¯¹æ¯”

| ç‰¹æ€§ | TCP | UDP |
|------|-----|-----|
| è¿æ¥ | é¢å‘è¿æ¥ | æ— è¿æ¥ |
| å¯é æ€§ | å¯é ï¼ˆä¸ä¸¢åŒ…ã€æŒ‰åºï¼‰ | ä¸å¯é ï¼ˆå¯èƒ½ä¸¢åŒ…ï¼‰ |
| ä¼ è¾“æ•ˆç‡ | è¾ƒä½ï¼ˆéœ€è¦ç¡®è®¤ï¼‰ | è¾ƒé«˜ |
| æ•°æ®å½¢å¼ | å­—èŠ‚æµ | æ•°æ®æŠ¥ |
| åº”ç”¨åœºæ™¯ | HTTPã€FTPã€é‚®ä»¶ | è§†é¢‘ã€DNSã€æ¸¸æˆ |
| Socket ç±» | Socket/ServerSocket | DatagramSocket |

---

### äº”ã€ç»¼åˆæ¡ˆä¾‹ï¼šç®€æ˜“èŠå¤©å®¤

**èŠå¤©å®¤æ¶æ„å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç®€æ˜“èŠå¤©å®¤æ¶æ„                     â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    èŠå¤©æœåŠ¡å™¨                          â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  ServerSocket (ç«¯å£ 8888)                       â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â”‚                         â”‚                            â”‚ â”‚
â”‚   â”‚                         â–¼                            â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  çº¿ç¨‹æ± ç®¡ç†å®¢æˆ·ç«¯è¿æ¥                            â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  ExecutorService pool = Executors.newFixedThreadPool(100)â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â”‚                         â”‚                            â”‚ â”‚
â”‚   â”‚                         â–¼                            â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  å®¢æˆ·ç«¯å¤„ç†å™¨é›†åˆ                               â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  Set<PrintWriter> clientWriters               â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â”‚                         â”‚                            â”‚ â”‚
â”‚   â”‚                         â–¼                            â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  æ¶ˆæ¯å¹¿æ’­æœºåˆ¶                                   â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  broadcast(message) â†’ æ‰€æœ‰å®¢æˆ·ç«¯               â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â–²                                   â”‚
â”‚                          â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚                â”‚                â”‚                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  å®¢æˆ·ç«¯1   â”‚   â”‚  å®¢æˆ·ç«¯2   â”‚   â”‚  å®¢æˆ·ç«¯N   â”‚            â”‚
â”‚   â”‚  Socket    â”‚   â”‚  Socket    â”‚   â”‚  Socket    â”‚            â”‚
â”‚   â”‚  ç”¨æˆ·åï¼šå¼ ä¸‰â”‚   â”‚  ç”¨æˆ·åï¼šæå››â”‚   â”‚  ç”¨æˆ·åï¼šç‹äº”â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚   æ¶ˆæ¯æµï¼š                                                  â”‚
â”‚   1. å®¢æˆ·ç«¯è¿æ¥ â†’ æœåŠ¡å™¨åˆ†é…çº¿ç¨‹                            â”‚
â”‚   2. å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ â†’ æœåŠ¡å™¨æ¥æ”¶                            â”‚
â”‚   3. æœåŠ¡å™¨å¹¿æ’­æ¶ˆæ¯ â†’ æ‰€æœ‰å®¢æˆ·ç«¯æ¥æ”¶                        â”‚
â”‚   4. å®¢æˆ·ç«¯æ–­å¼€ â†’ æœåŠ¡å™¨ç§»é™¤å¹¶é€šçŸ¥                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¤šå®¢æˆ·ç«¯æœåŠ¡å™¨æ¶æ„**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¤šå®¢æˆ·ç«¯æœåŠ¡å™¨æ¶æ„                 â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    ä¸»çº¿ç¨‹                              â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  ServerSocket.accept() - ç›‘å¬è¿æ¥              â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â”‚                         â”‚                            â”‚ â”‚
â”‚   â”‚                         â–¼                            â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  æ¥å—å®¢æˆ·ç«¯è¿æ¥                                â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â”‚                         â”‚                            â”‚ â”‚
â”‚   â”‚                         â–¼                            â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  æäº¤åˆ°çº¿ç¨‹æ±                                   â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  pool.execute(new ClientHandler(client))       â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    çº¿ç¨‹æ±                               â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚   â”‚  â”‚ Thread-1 â”‚  â”‚ Thread-2 â”‚  â”‚ Thread-N â”‚          â”‚ â”‚
â”‚   â”‚  â”‚ å®¢æˆ·ç«¯1  â”‚  â”‚ å®¢æˆ·ç«¯2  â”‚  â”‚ å®¢æˆ·ç«¯N  â”‚          â”‚ â”‚
â”‚   â”‚  â”‚ å¤„ç†é€»è¾‘ â”‚  â”‚ å¤„ç†é€»è¾‘ â”‚  â”‚ å¤„ç†é€»è¾‘ â”‚          â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚   â”‚         â”‚             â”‚             â”‚                â”‚ â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚
â”‚   â”‚                       â”‚                               â”‚ â”‚
â”‚   â”‚                       â–¼                               â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚  å…±äº«èµ„æºç®¡ç†                                    â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â€¢ å®¢æˆ·ç«¯åˆ—è¡¨                                   â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â€¢ æ¶ˆæ¯é˜Ÿåˆ—                                     â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â€¢ çŠ¶æ€åŒæ­¥                                     â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚   ä¼˜åŠ¿ï¼š                                                    â”‚
â”‚   â€¢ æ”¯æŒå¤šå®¢æˆ·ç«¯å¹¶å‘è¿æ¥                                    â”‚
â”‚   â€¢ çº¿ç¨‹æ± å¤ç”¨ï¼Œå‡å°‘èµ„æºæ¶ˆè€—                                â”‚
â”‚   â€¢ æ¯ä¸ªå®¢æˆ·ç«¯ç‹¬ç«‹å¤„ç†ï¼Œäº’ä¸å¹²æ‰°                            â”‚
â”‚   â€¢ ä¸»çº¿ç¨‹ä¸“æ³¨äºæ¥å—æ–°è¿æ¥                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```java
// èŠå¤©æœåŠ¡å™¨
public class ChatServer {
    private static Set<PrintWriter> clientWriters = ConcurrentHashMap.newKeySet();
    
    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(8888)) {
            System.out.println("èŠå¤©æœåŠ¡å™¨å¯åŠ¨...");
            
            while (true) {
                Socket socket = serverSocket.accept();
                new Thread(new ChatHandler(socket)).start();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    static class ChatHandler implements Runnable {
        private Socket socket;
        private PrintWriter out;
        private String clientName;
        
        public ChatHandler(Socket socket) {
            this.socket = socket;
        }
        
        @Override
        public void run() {
            try (BufferedReader in = new BufferedReader(
                    new InputStreamReader(socket.getInputStream()))) {
                
                out = new PrintWriter(socket.getOutputStream(), true);
                clientWriters.add(out);
                
                // è·å–ç”¨æˆ·å
                out.println("è¯·è¾“å…¥ç”¨æˆ·åï¼š");
                clientName = in.readLine();
                broadcast(clientName + " åŠ å…¥èŠå¤©å®¤");
                
                String message;
                while ((message = in.readLine()) != null) {
                    broadcast(clientName + ": " + message);
                }
            } catch (IOException e) {
                System.out.println(clientName + " æ–­å¼€è¿æ¥");
            } finally {
                clientWriters.remove(out);
                broadcast(clientName + " ç¦»å¼€èŠå¤©å®¤");
            }
        }
        
        private void broadcast(String message) {
            for (PrintWriter writer : clientWriters) {
                writer.println(message);
            }
        }
    }
}
```

---

## é—®ç­”

### Q1ï¼šTCP ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”**ï¼š
1. **SYN**ï¼šå®¢æˆ·ç«¯å‘é€ SYN åŒ…åˆ°æœåŠ¡å™¨ï¼Œè¿›å…¥ SYN_SENT çŠ¶æ€ã€‚
2. **SYN-ACK**ï¼šæœåŠ¡å™¨æ”¶åˆ° SYNï¼Œå›å¤ SYN-ACK åŒ…ï¼Œè¿›å…¥ SYN_RECV çŠ¶æ€ã€‚
3. **ACK**ï¼šå®¢æˆ·ç«¯æ”¶åˆ° SYN-ACKï¼Œå›å¤ ACK åŒ…ï¼ŒåŒæ–¹è¿›å…¥ ESTABLISHED çŠ¶æ€ã€‚

**ç›®çš„**ï¼šç¡®ä¿åŒæ–¹æ”¶å‘èƒ½åŠ›æ­£å¸¸ï¼ŒåŒæ­¥åˆå§‹åºåˆ—å·ã€‚

### Q2ï¼šUDP å¦‚ä½•å®ç°å¯é ä¼ è¾“ï¼Ÿ

**ç­”**ï¼š
- UDP æœ¬èº«ä¸å¯é ï¼Œéœ€è¦åœ¨åº”ç”¨å±‚å®ç°å¯é æ€§æœºåˆ¶ã€‚
- **å®ç°æ–¹å¼**ï¼š
  - æ·»åŠ åºåˆ—å·å’Œç¡®è®¤æœºåˆ¶
  - è¶…æ—¶é‡ä¼ 
  - æ•°æ®æ ¡éªŒï¼ˆCRCï¼‰
  - æµé‡æ§åˆ¶
- **ç¤ºä¾‹**ï¼šQUIC åè®®åŸºäº UDP å®ç°äº†å¯é ä¼ è¾“ã€‚

### Q3ï¼šSocket è¿æ¥è¶…æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ

**ç­”**ï¼š
```java
Socket socket = new Socket();
socket.connect(new InetSocketAddress(host, port), 5000);  // 5ç§’è¶…æ—¶

// æˆ–ä½¿ç”¨æ„é€ å™¨
Socket socket = new Socket();
socket.setSoTimeout(5000);  // è¯»å–è¶…æ—¶
```

### Q4ï¼šå¦‚ä½•å®ç°å¤šå®¢æˆ·ç«¯æœåŠ¡å™¨ï¼Ÿ

**ç­”**ï¼š
- ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ›å»ºæ–°çº¿ç¨‹ã€‚
- ä½¿ç”¨çº¿ç¨‹æ± ç®¡ç†å®¢æˆ·ç«¯çº¿ç¨‹ã€‚
- ä½¿ç”¨ NIOï¼ˆéé˜»å¡ IOï¼‰æˆ– Netty æ¡†æ¶å¤„ç†é«˜å¹¶å‘ã€‚

```java
ExecutorService pool = Executors.newFixedThreadPool(100);
while (true) {
    Socket client = serverSocket.accept();
    pool.execute(new ClientHandler(client));
}
```

### Q5ï¼šç½‘ç»œç¼–ç¨‹ä¸­å¸¸è§çš„å¼‚å¸¸æœ‰å“ªäº›ï¼Ÿ

**ç­”**ï¼š
- `UnknownHostException`ï¼šä¸»æœºåæ— æ³•è§£æ
- `ConnectException`ï¼šè¿æ¥è¢«æ‹’ç»ï¼ˆæœåŠ¡å™¨æœªå¯åŠ¨æˆ–ç«¯å£é”™è¯¯ï¼‰
- `SocketTimeoutException`ï¼šè¿æ¥æˆ–è¯»å–è¶…æ—¶
- `BindException`ï¼šç«¯å£å·²è¢«å ç”¨
- `SocketException`ï¼šè¿æ¥è¢«é‡ç½®æˆ–å…³é—­

---

> **å­¦ä¹ å»ºè®®**ï¼šç½‘ç»œç¼–ç¨‹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºç¡€ï¼ŒåŠ¡å¿…ç†è§£ TCP/UDP çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ã€‚å»ºè®®å¤šå†™ç»ƒä¹ ï¼Œç‰¹åˆ«æ˜¯ Socket é€šä¿¡å’Œæ–‡ä»¶ä¼ è¾“ã€‚å¯ä»¥å°è¯•å®ç°ä¸€ä¸ªç®€å•çš„ HTTP æœåŠ¡å™¨æˆ–èŠå¤©å®¤ï¼ŒåŠ æ·±ç†è§£ã€‚
